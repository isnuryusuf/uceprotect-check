#!/bin/sh


############################
##  Convert Blok IP
############################
rm -rf /opt/rblcheck/list-ip.txt


items="
 103.7.176.0/24
 103.44.26.0/23
 103.44.26.0/24
 103.44.27.0/24
 103.58.100.0/24
 103.58.101.0/24
 103.58.102.0/24
 103.58.103.0/24
 103.77.104.0/24
 103.77.105.0/24
 103.89.0.0/22
 103.89.4.0/22
 103.89.154.0/24
 103.89.164.0/24
 103.93.52.0/22
 103.93.56.0/22
 103.93.64.0/24
 103.93.65.0/24
 103.93.66.0/24
 103.93.67.0/24
 103.93.128.0/24
 103.93.129.0/24
 103.93.130.0/24
 103.93.131.0/24
 103.93.132.0/22
 103.93.160.0/22
 103.150.84.0/23
 103.150.84.0/24
 103.150.85.0/24
 103.150.86.0/23
 103.150.86.0/24
 103.150.87.0/24
 103.150.88.0/23
 103.150.90.0/23
 116.206.196.0/23
 116.206.198.0/24
 116.206.199.0/24
 137.59.124.0/23
 137.59.124.0/24
 137.59.125.0/24
 137.59.126.0/24
 137.59.127.0/24
"

IFS='
'
count=0
for item in ${items//\\n/$cr}
do
	#echo $item > /dev/null  
	/opt/rblcheck/netmask.sh $item >> list-ip.txt
done


#######################
##  DNSBLS
#######################
rm -rf /opt/rblcheck/result.txt

IP_LIST=$(cat list-ip.txt)

for i in $IP_LIST
do 
	/opt/rblcheck/rbl_check_only $i  >> /opt/rblcheck/result.txt
done

body="$(grep -i "UCEPROTECT-Level" /opt/rblcheck/result.txt)" && echo "$body" | mailx -s "UCE-Protect Blacklist" yusuf@biznetgio.com
